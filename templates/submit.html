{% extends 'base.html' %}

{% block head %}
<link rel="stylesheet" href="/static/css/submit.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
    href="https://fonts.googleapis.com/css2?family=Urbanist:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
    rel="stylesheet">
<link
    href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&display=swap"
    rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
    crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/exif-js/2.3.0/exif.js"></script>
{% endblock %}

{% block body %}
<nav class="navbar">
    <hr class="line" size="1" />
    <ul class="navbar-links">
        <li><a href="/dashboard/{{ user.user_id }}">dashboard</a></li>
        <li><a href="/library">library</a></li>
        <li><a href="/map">map</a></li>
        <li><a href="/albums/{{ user.user_id }}">albums</a></li>
        <li><a href="/submit/{{ user.user_id }}">submit</a></li>
        <li><a href="#">log_out</a></li>
    </ul>
</nav>

<div class="container-fluid">
    <label for="file-drop-area">Upload a geotagged image of the structure you want to submit. Geocoding will do
        the
        rest.</label>
    <div class="row">
        <div class="col-lg-6 d-flex align-items-center justify-content-center" style="min-height: 70vh;">
            <form id="structure-submission" action="/submit/{{ user.user_id }}" method="POST"
                enctype="multipart/form-data">
                <div class="file-drop-area" id="file-drop-area">
                    <span class="choose-file-button">Choose files</span>
                    <span class="file-message">or drag and drop files here</span>
                    <input class="file-input" type="file" name="file" multiple>
                </div>
        </div>
        <div class="col-lg-6 align-items-center justify-content-center" style="min-height: 70vh;">
            <div class="form-group">
                <input type="text" class="form-control" name="user-structure-name" id="user-structure-name"
                    placeholder="Structure Name">
                <select class="form-control" name="user-typology" id="user-typology">
                    <option value="null">Structure Typology</option>
                    <option value="office">Office</option>
                    <option value="residential">Residential</option>
                    <option value="retail">Retail</option>
                    <option value="hospitality">Hospitality</option>
                    <option value="cultural">Cultural</option>
                    <option value="multi-purpose">Multi-Purpose</option>
                    <option value="institutional-civic">Institutional Civic</option>
                    <option value="gathering">Gathering</option>
                    <option value="religious">Religious</option>
                    <option value="educational">Educational</option>
                    <option value="industrial">Industrial</option>
                    <option value="agricultural">Agricultural</option>
                    <option value="recreational">Recreational</option>
                    <option value="terminal">Terminal</option>
                    <option value="landmark">Landmark</option>
                </select>
                <br>
                <input type="text" class="form-control" name="user-address" id="user-address"
                    placeholder="Street Address">
                <input type="text" class="form-control" name="user-city" id="user-city" placeholder="City">
                <select class="form-control" name="user-state" id="user-state">
                    <option value="null">State/Province</option>
                    <option value="AL">Alabama</option>
                    <option value="AK">Alaska</option>
                    <option value="AZ">Arizona</option>
                    <option value="AR">Arkansas</option>
                    <option value="CA">California</option>
                    <option value="CO">Colorado</option>
                    <option value="CT">Connecticut</option>
                    <option value="DE">Delaware</option>
                    <option value="DC">District Of Columbia</option>
                    <option value="FL">Florida</option>
                    <option value="GA">Georgia</option>
                    <option value="HI">Hawaii</option>
                    <option value="ID">Idaho</option>
                    <option value="IL">Illinois</option>
                    <option value="IN">Indiana</option>
                    <option value="IA">Iowa</option>
                    <option value="KS">Kansas</option>
                    <option value="KY">Kentucky</option>
                    <option value="LA">Louisiana</option>
                    <option value="ME">Maine</option>
                    <option value="MD">Maryland</option>
                    <option value="MA">Massachusetts</option>
                    <option value="MI">Michigan</option>
                    <option value="MN">Minnesota</option>
                    <option value="MS">Mississippi</option>
                    <option value="MO">Missouri</option>
                    <option value="MT">Montana</option>
                    <option value="NE">Nebraska</option>
                    <option value="NV">Nevada</option>
                    <option value="NH">New Hampshire</option>
                    <option value="NJ">New Jersey</option>
                    <option value="NM">New Mexico</option>
                    <option value="NY">New York</option>
                    <option value="NC">North Carolina</option>
                    <option value="ND">North Dakota</option>
                    <option value="OH">Ohio</option>
                    <option value="OK">Oklahoma</option>
                    <option value="OR">Oregon</option>
                    <option value="PA">Pennsylvania</option>
                    <option value="RI">Rhode Island</option>
                    <option value="SC">South Carolina</option>
                    <option value="SD">South Dakota</option>
                    <option value="TN">Tennessee</option>
                    <option value="TX">Texas</option>
                    <option value="UT">Utah</option>
                    <option value="VT">Vermont</option>
                    <option value="VA">Virginia</option>
                    <option value="WA">Washington</option>
                    <option value="WV">West Virginia</option>
                    <option value="WI">Wisconsin</option>
                    <option value="WY">Wyoming</option>
                    <option value="AB">Alberta</option>
                    <option value="BC">British Columbia</option>
                    <option value="MB">Manitoba</option>
                    <option value="NB">New Brunswick</option>
                    <option value="NL">Newfoundland & Labrador</option>
                    <option value="NT">Northwest Territories</option>
                    <option value="NS">Nova Scotia</option>
                    <option value="NU">Nunavut</option>
                    <option value="ON">Ontario</option>
                    <option value="PE">Prince Edward Island</option>
                    <option value="QC">Quebec</option>
                    <option value="SK">Saskatchewan</option>
                    <option value="YT">Yukon</option>
                </select>
                <input type="text" class="form-control" name="user-country" id="user-country" placeholder="Country">
                <input type="hidden" id="user-lat" name="user-lat">
                <input type="hidden" id="user-lng" name="user-lng">
            </div>
            <button type="submit" class="btn btn-primary">Submit</button>
            </form>
        </div>
    </div>
</div>

<div class="modal fade" id="mapModal" tabindex="-1" role="dialog" aria-labelledby="mapModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <p>It appears the image you chose to upload is not geotagged. Either select the
                    location of your
                    submission using the map below, or enter the address manually.</p>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div id="map" style="height: 400px;"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Manual Address Entry</button>
                <button type="button" class="btn btn-primary" id="confirmLocation">Confirm Location</button>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    const userId = "{{ user.user_id }}";
</script>
<script src="/static/js/submit.js"></script>
<script>
    const currentPath = window.location.pathname;
    const navLinks = document.querySelectorAll('.navbar a');

    navLinks.forEach(link => {
        if (link.getAttribute('href') === currentPath) {
            link.classList.add('active-link');
        }
    });
</script>
<script async
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDSMrST6tA5LevywsZYvPXPsmIqhlbmRg4&callback=initMap"></script>
{% endblock %}